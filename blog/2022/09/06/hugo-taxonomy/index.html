<!doctype html><html lang=ja prefix="og: https://ogp.me/ns#"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=preload href=https://kakudokentaro.com/assets/fonts/Inter-SemiBold.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://kakudokentaro.com/assets/fonts/Inter-Regular.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=https://kakudokentaro.com/assets/css/null-2.4.css><link rel=stylesheet href=https://kakudokentaro.com/assets/css/common.css><link rel="shortcut icon" href=https://kakudokentaro.com/assets/favicon.svg type=image/svg+xml><link rel=stylesheet href=https://kakudokentaro.com/assets/css/document.css><link rel=stylesheet href=https://kakudokentaro.com/assets/css/single.css><title>HugoのTaxonomyを設定する - Kakudo Kentaro</title><meta name=description content="HugoのTaxonomy（タグ・カテゴリ）について。設定や無効化の方法。"><meta property="og:description" content="HugoのTaxonomy（タグ・カテゴリ）について。設定や無効化の方法。"><meta property="og:title" content="HugoのTaxonomyを設定する - Kakudo Kentaro"><meta property="og:type" content="website"><meta property="og:image" content="https://kakudokentaro.com/assets/icon.png"><meta property="og:url" content="https://kakudokentaro.com/blog/2022/09/06/hugo-taxonomy/"><meta property="og:site_name" content="Kakudo Kentaro"><meta name=twitter:card content="summary"><meta name=twitter:creator content="@kakudo415"></head><body><header><div class=inner><h1><a href=https://kakudokentaro.com/>Kakudo Kentaro</a></h1><a href=https://kakudokentaro.com/blog/>Blog</a>
<a href=https://kakudokentaro.com/about/>About</a></div></header><main><div class=inner><h1>HugoのTaxonomyを設定する</h1><time datetime=2022-09-06>2022-09-06 01:12</time><ul class=tags><li><a href=https://kakudokentaro.com/blog/tags/web/>Web</a></li><li><a href=https://kakudokentaro.com/blog/tags/hugo/>Hugo</a></li></ul><p>ブログを書き始めて6日。だんだんHugoの気持ちがわかってきました。そろそろTaxonomy（分類）も触れたいなと感じたので、このブログに「タグ」を導入したいと思います。</p><h2 id=タグを設定する>タグを設定する</h2><h3 id=archetypesにデフォルトのfront-matterを書く>ArchetypesにデフォルトのFront Matterを書く</h3><p><code>/archetypes/</code>内にテンプレートを置いておくことで、新しい記事を作成したときにテンプレートの内容が原稿にコピーされて便利です。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#555>---</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:navy>title</span>:<span style=color:#bbb> </span><span style=color:#d14>&#34;{{ replace .Name &#34;</span>-<span style=color:#d14>&#34; &#34;</span><span style=color:#bbb> </span><span style=color:#d14>&#34; | title }}&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:navy>date</span>:<span style=color:#bbb> </span>{{<span style=color:#bbb> </span>.Date }}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:navy>description</span>:<span style=color:#bbb> </span><span style=color:#d14>&#34;&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:navy>tags</span>:<span style=color:#bbb> </span>[]<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#555>---</span><span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=configtomlの編集>config.tomlの編集</h3><p><a href=https://discourse.gohugo.io/t/custom-taxonomy-under-section/12905/13>Custom taxonomy under section? - support - HUGO</a>が非常に参考になりました。ありがとうございます。</p><p>以下のように追記します。今回は、<code>/blog/</code>下でタグを管理したかったので、パーマリンクをイジっています。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-toml data-lang=toml><span style=display:flex><span>[taxonomies]
</span></span><span style=display:flex><span>  tag = <span style=color:#d14>&#39;tags&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[permalinks]
</span></span><span style=display:flex><span>  <span style=color:#d14>&#39;/tags&#39;</span> = <span style=color:#d14>&#39;/blog/tags/:slug&#39;</span>
</span></span></code></pre></div><h4 id=taxonomies>taxonomies</h4><p><code>内部的な分類方法名 = パス等に使うときの分類方法名</code>という形で設定します。（<code>単数形 = 複数形</code>が想定されている？）</p><p>参考: <a href=https://gohugo.io/content-management/taxonomies#configure-taxonomies>Taxonomies | Hugo</a></p><h4 id=permalinks>permalinks</h4><p>デフォルトだと<code>/tags/</code>下でタグ関係のページが公開されてしまうので、それを置き換えています。</p><p>参考: <a href=https://gohugo.io/content-management/urls/#permalinks>URL Management | Hugo</a></p><h3 id=記事ページでのタグ>記事ページでのタグ</h3><p>記事ページ（<code>single.html</code>）内では、<code>.Params.tags</code>にその記事が持つタグが全て入っています。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-html data-lang=html><span style=display:flex><span>  {{ range .Params.tags }}
</span></span><span style=display:flex><span>    &lt;<span style=color:navy>li</span>&gt;&lt;<span style=color:navy>a</span> <span style=color:teal>href</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;{{ $.Site.BaseURL }}blog/tags/{{ . | urlize}}&#34;</span>&gt;{{ . }}&lt;/<span style=color:navy>a</span>&gt;&lt;/<span style=color:navy>li</span>&gt;
</span></span><span style=display:flex><span>  {{ end }}
</span></span></code></pre></div><p>このブログでは現在以上のようになっています。組み込みの<code>urlize</code>関数が便利ですね。</p><p>参考: <a href=https://gohugo.io/templates/single-page-templates/>Single Page Templates | Hugo</a></p><h3 id=タグを持つ記事一覧>タグを持つ記事一覧</h3><p><code>taxonomy.html</code>内の<code>.Pages</code>にそのタグを持つ記事が全て入っています。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-html data-lang=html><span style=display:flex><span>{{ range .Pages }}
</span></span><span style=display:flex><span>  &lt;<span style=color:navy>article</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:navy>h4</span>&gt;&lt;<span style=color:navy>a</span> <span style=color:teal>href</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;{{ .Permalink }}&#34;</span> <span style=color:teal>class</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;unread-marker&#34;</span>&gt;{{ .Title }}&lt;/<span style=color:navy>a</span>&gt;&lt;/<span style=color:navy>h2</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:navy>time</span> <span style=color:teal>datetime</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;{{ .Date.Format &#34;</span><span style=color:teal>2006-01-02</span><span style=color:#a61717;background-color:#e3d2d2>&#34;</span> <span style=color:#a61717;background-color:#e3d2d2>}}&#34;</span>&gt;{{ .Date.Format &#34;2006-01-02&#34; }}&lt;/<span style=color:navy>time</span>&gt;
</span></span><span style=display:flex><span>  &lt;/<span style=color:navy>article</span>&gt;
</span></span><span style=display:flex><span>{{ end }}
</span></span></code></pre></div><p>このブログでは現在以上のようになっています。</p><h3 id=タグ一覧>タグ一覧</h3><p><code>terms.html</code>内の<code>.Site.Taxonomies.tags</code>にタグについて情報が入っています。今回は、<code>.ByCount</code>を使って、記事数に応じて並び替えています。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-html data-lang=html><span style=display:flex><span>{{ range .Site.Taxonomies.tags.ByCount }}
</span></span><span style=display:flex><span>  &lt;<span style=color:navy>article</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:navy>h4</span>&gt;&lt;<span style=color:navy>a</span> <span style=color:teal>href</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;{{ $.Site.BaseURL }}blog/tags/{{ .Name | urlize }}/&#34;</span> <span style=color:teal>class</span><span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#34;unread-marker&#34;</span>&gt;# {{ .Name }} ({{ .Count }})&lt;/<span style=color:navy>a</span>&gt;&lt;/<span style=color:navy>h2</span>&gt;
</span></span><span style=display:flex><span>  &lt;/<span style=color:navy>article</span>&gt;
</span></span><span style=display:flex><span>{{ end }}
</span></span></code></pre></div><h2 id=taxonomyの完全部分的な無効化>Taxonomyの完全・部分的な無効化</h2><p>タグ等のTaxonomyを使わない場合は無効化することができます。
無駄なページが生まれるだけなので、必要ないなら切ってしまっても良いかと思います。</p><h3 id=完全な無効化>完全な無効化</h3><p>以下の設定で、Taxonomy機能自体を無効化できます。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-toml data-lang=toml><span style=display:flex><span>disableKinds = [<span style=color:#d14>&#39;taxonomy&#39;</span>]
</span></span><span style=display:flex><span>ignoreErrors = [<span style=color:#d14>&#34;error-disable-taxonomy&#34;</span>]
</span></span></code></pre></div><p>単に<code>disableKinds</code>に追加すればよいかと思いきや、</p><pre tabindex=0><code>ERROR 2022/09/06 00:56:59 You have the value &#39;taxonomy&#39; in the disabledKinds list. In Hugo 0.73.0 we fixed these to be what most people expect (taxonomy and term).
But this also means that your site configuration may not do what you expect. If it is correct, you can suppress this message by following the instructions below.
If you feel that this should not be logged as an ERROR, you can ignore it by adding this to your site config:
ignoreErrors = [&#34;error-disable-taxonomy&#34;]
</code></pre><p>と怒られてしまうので、言われた通りに<code>ignoreErrors = ["error-disable-taxonomy"]</code>を追加しています。</p><h3 id=部分的な無効化>部分的な無効化</h3><p>Categoryだけ要らないといった場合は、デフォルトの設定を上書きすることで無効化することができます。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-toml data-lang=toml><span style=display:flex><span>[taxonomies]
</span></span><span style=display:flex><span>  tag = <span style=color:#d14>&#39;tags&#39;</span>
</span></span></code></pre></div><p>たとえば、このブログの設定はこのようになっていますが、デフォルトであるはずの<code>category</code>を書かなかったため、その機能が無効化されています。</p><p><a href=https://gohugo.io/content-management/taxonomies#example-removing-default-taxonomies>Taxonomies | Hugo</a>も併せてご覧ください。</p><section class=share><div>Share on</div><a href="https://twitter.com/intent/tweet?text=Hugo%e3%81%aeTaxonomy%e3%82%92%e8%a8%ad%e5%ae%9a%e3%81%99%e3%82%8b - Kakudo%20Kentaro&url=https%3a%2f%2fkakudokentaro.com%2fblog%2f2022%2f09%2f06%2fhugo-taxonomy%2f" rel="nofollow noopener noreferrer" target=_blank>Twitter</a></section></div></main></body></html>